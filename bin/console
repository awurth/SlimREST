#!/usr/bin/env php
<?php

require __DIR__.'/../vendor/autoload.php';

use App\Application;
use App\Command\DatabaseCommand;
use App\Command\RoutesCommand;
use App\Command\CreateUserCommand;
use Symfony\Component\Console\Application as Console;
use Symfony\Component\Dotenv\Dotenv;

if (!isset($_SERVER['APP_ENV'])) {
    if (!class_exists(Dotenv::class)) {
        throw new \RuntimeException('APP_ENV environment variable is not defined. You need to define environment variables for configuration or add "symfony/dotenv" as a Composer dependency to load variables from a .env file.');
    }
    (new Dotenv())->load(__DIR__.'/../.env');
}

$app = new Application('dev');
$container = $app->getContainer();

$console = new Console();

$console->add(new CreateUserCommand($container['sentinel']));
$console->add(new DatabaseCommand());
$console->add(new RoutesCommand($container['router'], $container['settings']['rest']));

$console->run();
